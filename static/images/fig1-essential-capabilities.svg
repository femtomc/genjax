<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="825.0000" height="225.0000" viewBox="50.0000 50.0000 825.0000 225.0000" role="img" shape-rendering="geometricPrecision">
  <rect id="p1-outer" x="50.0000" y="50.0000" width="240.0000" height="180.0000" fill="#f8fafc" stroke="#334155" stroke-width="1.5000"/>
  <text id="p1-outer-label" x="60.0000" y="70.0000" font-size="11.0000" font-family="system-ui, sans-serif" transform="translate(0.0000, 4.4000)" fill="#475569">vmap of simulate of</text>
  <rect id="p1-inner" x="80.0000" y="95.0000" width="180.0000" height="100.0000" fill="#f1f5f9" stroke="#64748b" stroke-width="1.0000"/>
  <text id="p1-inner-label" x="90.0000" y="115.0000" font-size="10.0000" font-family="system-ui, sans-serif" transform="translate(0.0000, 4.0000)" fill="#475569">vmap of model</text>
  <circle id="p1-dot1" cx="120.0000" cy="155.0000" r="6.0000" fill="#93c5fd"/>
  <circle id="p1-dot2" cx="150.0000" cy="155.0000" r="6.0000" fill="#93c5fd"/>
  <circle id="p1-dot3" cx="180.0000" cy="155.0000" r="6.0000" fill="#93c5fd"/>
  <circle id="p1-dot4" cx="210.0000" cy="155.0000" r="6.0000" fill="#93c5fd"/>
  <text id="p1-title" x="170.0000" y="255.0000" font-size="13.0000" font-family="system-ui, sans-serif" text-anchor="middle" transform="translate(0.0000, 5.2000)" fill="#1e293b">vmap in Modeling and Inference</text>
  <text id="p1-subtitle" x="170.0000" y="275.0000" font-size="10.0000" font-family="system-ui, sans-serif" text-anchor="middle" transform="translate(0.0000, 4.0000)" fill="#64748b">Vectorization applies compositionally</text>
  <rect id="p2-trace1" x="370.0000" y="70.0000" width="200.0000" height="60.0000" fill="#f1f5f9" stroke="#64748b" stroke-width="1.0000"/>
  <text id="p2-trace1-label" x="380.0000" y="60.0000" font-size="10.0000" font-family="system-ui, sans-serif" transform="translate(0.0000, 4.0000)" fill="#334155">trace ~ P</text>
  <text id="p2-trace1-content" x="470.0000" y="105.0000" font-size="10.0000" font-family="monospace" text-anchor="middle" transform="translate(0.0000, 4.0000)" fill="#475569">{&quot;a&quot;: f32[], &quot;b&quot;: f32[]}</text>
  <path id="p2-arrow" d="M 470.0000 140.0000 L 470.0000 165.0000 " fill="none" stroke="#64748b" stroke-width="1.5000" marker-end="url(#url(#arrowhead))"/>
  <path id="p2-arrow-tip" d="M 465.0000 160.0000 L 470.0000 165.0000 L 475.0000 160.0000 " fill="none" stroke="#64748b" stroke-width="1.5000"/>
  <rect id="p2-trace2" x="370.0000" y="175.0000" width="200.0000" height="60.0000" fill="#f1f5f9" stroke="#64748b" stroke-width="1.0000"/>
  <text id="p2-trace2-label" x="380.0000" y="165.0000" font-size="10.0000" font-family="system-ui, sans-serif" transform="translate(0.0000, 4.0000)" fill="#334155">trace ~ vmap{P}</text>
  <text id="p2-trace2-content" x="470.0000" y="210.0000" font-size="10.0000" font-family="monospace" text-anchor="middle" transform="translate(0.0000, 4.0000)" fill="#475569">{&quot;a&quot;: f32[N], &quot;b&quot;: f32[N]}</text>
  <text id="p2-title" x="470.0000" y="255.0000" font-size="13.0000" font-family="system-ui, sans-serif" text-anchor="middle" transform="translate(0.0000, 5.2000)" fill="#1e293b">Vectorized Traces</text>
  <text id="p2-subtitle" x="470.0000" y="275.0000" font-size="10.0000" font-family="system-ui, sans-serif" text-anchor="middle" transform="translate(0.0000, 4.0000)" fill="#64748b">Struct-of-arrays memory layout</text>
  <circle id="p3-start" cx="770.0000" cy="80.0000" r="10.0000" fill="#86efac" stroke="#22c55e" stroke-width="1.5000"/>
  <path id="p3-diamond" d="M 770.0000 115.0000 L 795.0000 140.0000 L 770.0000 165.0000 L 745.0000 140.0000 Z " fill="#fef08a" stroke="#eab308" stroke-width="1.5000"/>
  <text id="p3-diamond-label" x="770.0000" y="145.0000" font-size="12.0000" font-family="system-ui, sans-serif" text-anchor="middle" transform="translate(0.0000, 4.8000)" fill="#854d0e">X</text>
  <path id="p3-line1" d="M 770.0000 90.0000 L 770.0000 115.0000 " fill="none" stroke="#475569" stroke-width="1.5000"/>
  <path id="p3-left-branch" d="M 758.0000 152.0000 L 730.0000 190.0000 " fill="none" stroke="#475569" stroke-width="1.5000"/>
  <path id="p3-right-branch" d="M 782.0000 152.0000 L 810.0000 190.0000 " fill="none" stroke="#475569" stroke-width="1.5000"/>
  <circle id="p3-end1" cx="730.0000" cy="195.0000" r="8.0000" fill="#fca5a5" stroke="#ef4444" stroke-width="1.5000"/>
  <circle id="p3-end2" cx="810.0000" cy="195.0000" r="8.0000" fill="#fca5a5" stroke="#ef4444" stroke-width="1.5000"/>
  <text id="p3-label-p" x="740.0000" y="170.0000" font-size="10.0000" font-family="system-ui, sans-serif" transform="translate(0.0000, 4.0000)" fill="#475569">p</text>
  <text id="p3-label-1p" x="800.0000" y="170.0000" font-size="10.0000" font-family="system-ui, sans-serif" transform="translate(0.0000, 4.0000)" fill="#475569">1-p</text>
  <text id="p3-title" x="770.0000" y="255.0000" font-size="13.0000" font-family="system-ui, sans-serif" text-anchor="middle" transform="translate(0.0000, 5.2000)" fill="#1e293b">Stochastic Branching</text>
  <text id="p3-subtitle" x="770.0000" y="275.0000" font-size="10.0000" font-family="system-ui, sans-serif" text-anchor="middle" transform="translate(0.0000, 4.0000)" fill="#64748b">Branches on random values preserved</text>
</svg>
