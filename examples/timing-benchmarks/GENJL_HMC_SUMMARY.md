# Gen.jl HMC Implementation Summary

This document summarizes the Gen.jl HMC implementation for polynomial regression benchmarking.

## Implementation Overview

The Gen.jl HMC implementation follows the same polynomial regression model as other frameworks:
- Parameters: a, b, c ~ Normal(0, 1)
- Observations: y ~ Normal(a + bx + cx^2, 0.05)

## Key Files Modified/Created

### 1. **julia/src/polynomial_regression.jl**
- Added configurable HMC parameters: `step_size` and `n_leapfrog`
- Updated the `run_polynomial_hmc_benchmark` function to accept these parameters
- Fixed framework name to be consistent ("genjl" instead of "genjl_dynamic" or "gen.jl")

### 2. **src/timing_benchmarks/curvefit-benchmarks/genjl.py**
- Renamed functions to follow naming convention: `genjl_polynomial_hmc_timing`
- Added support for HMC parameters (`step_size`, `n_leapfrog`) via kwargs
- Already had HMC support, just needed parameter passing

### 3. **src/timing_benchmarks/julia_interface.py**
- Updated `run_polynomial_hmc` to accept `step_size` and `n_leapfrog` parameters
- Modified Julia script generation to pass these parameters to the benchmark

### 4. **run_hmc_benchmarks.py**
- Added "genjl" to the default frameworks list
- Added Gen.jl-specific parameter handling in `run_framework_hmc`

## Running the Benchmarks

### Test Run
```bash
python test_genjl_hmc.py
```

### Full HMC Benchmarks with Gen.jl
```bash
python run_hmc_benchmarks.py --frameworks genjax numpyro genjl --chain-lengths 100 500 1000 5000
```

### Quick Test Script
```bash
./test_hmc_with_genjl.sh
```

## Output Format

The Gen.jl HMC results follow the same format as other frameworks:
```json
{
  "framework": "genjl",
  "method": "hmc",
  "times": [0.123, 0.124, ...],
  "mean_time": 0.1235,
  "std_time": 0.0012,
  "samples": {
    "a": [...],
    "b": [...],
    "c": [...]
  },
  "n_samples": 1000,
  "n_warmup": 500
}
```

## Visualization

The results are automatically included in the comparison plots generated by:
```bash
python combine_results.py --frameworks genjax numpyro genjl
```

Gen.jl appears with the color '#AA3377' and display name 'Gen.jl' in the plots.