from beartype import BeartypeConf
from beartype.claw import beartype_this_package

conf = BeartypeConf(
    is_color=True,
    is_debug=False,
    is_pep484_tower=True,
    violation_type=TypeError,
)

beartype_this_package(conf=conf)

from .adev import (  # noqa: E402
    Dual,
    categorical_enum_parallel,
    expectation,
    flip_enum,
    flip_enum_parallel,
    flip_mvd,
    flip_reinforce,
    geometric_reinforce,
    normal_reinforce,
    normal_reparam,
    multivariate_normal_reparam,
    multivariate_normal_reinforce,
)
from .core import (  # noqa: E402
    GFI,
    Distribution,
    Fn,
    Pytree,
    Const,
    const,
    Trace,
    Vmap,
    Scan,
    Cond,
    gen,
    get_choices,
    tfp_distribution,
    trace,
    sel,
    Selection,
)
from .pjax import (  # noqa: E402
    modular_vmap,
    seed,
)
from .distributions import (  # noqa: E402
    bernoulli,
    beta,
    categorical,
    flip,
    normal,
    uniform,
    exponential,
    poisson,
    multivariate_normal,
)
from .mcmc import (  # noqa: E402
    MCMCResult,
    chain,
    mh,
    mala,
    compute_rhat,
    compute_ess,
)
from .smc import (  # noqa: E402
    ParticleCollection,
    init,
    change,
    extend,
    rejuvenate,
    resample,
    rejuvenation_smc,
)

# Import extras module for additional functionality
from . import extras  # noqa: E402
from .extras import (  # noqa: E402
    discrete_hmm,
    forward_filter,
    backward_sample,
    forward_filtering_backward_sampling,
    compute_sequence_log_prob,
    sample_hmm_dataset,
    DiscreteHMMTrace,
)

__all__ = [
    "GFI",
    "Distribution",
    "Dual",
    "Fn",
    "Pytree",
    "Const",
    "const",
    "Trace",
    "Vmap",
    "Scan",
    "Cond",
    "bernoulli",
    "beta",
    "uniform",
    "exponential",
    "poisson",
    "categorical",
    "categorical_enum_parallel",
    "expectation",
    "flip",
    "flip_enum",
    "flip_enum_parallel",
    "flip_mvd",
    "flip_reinforce",
    "gen",
    "geometric_reinforce",
    "get_choices",
    "MCMCResult",
    "chain",
    "mh",
    "mala",
    "compute_rhat",
    "compute_ess",
    "modular_vmap",
    "normal",
    "normal_reinforce",
    "normal_reparam",
    "multivariate_normal",
    "multivariate_normal_reparam",
    "multivariate_normal_reinforce",
    "seed",
    "sel",
    "Selection",
    "tfp_distribution",
    "trace",
    "ParticleCollection",
    "init",
    "change",
    "extend",
    "rejuvenate",
    "resample",
    "rejuvenation_smc",
    "extras",
    "discrete_hmm",
    "forward_filter",
    "backward_sample",
    "forward_filtering_backward_sampling",
    "compute_sequence_log_prob",
    "sample_hmm_dataset",
    "DiscreteHMMTrace",
]
